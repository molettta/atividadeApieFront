<!DOCTYPE html>
<!-- ============================================
     P√ÅGINA HTML - FRONTEND DA APLICA√á√ÉO
     ============================================
     Este arquivo cria a interface visual que o usu√°rio v√™ no navegador
     √â como a "cara" da aplica√ß√£o, o que aparece na tela
-->

<html lang="pt-BR">
<head>
    <!-- ============================================
         CONFIGURA√á√ïES DA P√ÅGINA (Meta Tags)
         ============================================ -->
    <meta charset="UTF-8">  <!-- Define que vamos usar caracteres especiais (√ß, √£, etc) -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  <!-- Responsivo para celular -->
    <title>API Frontend - Exerc√≠cio</title>  <!-- T√≠tulo que aparece na aba do navegador -->
    
    <!-- ============================================
         ESTILOS CSS (Apar√™ncia Visual)
         ============================================
         CSS = Cascading Style Sheets (Folhas de Estilo)
         Define cores, tamanhos, posi√ß√µes, etc.
    -->
    <style>
        /* Reset b√°sico: remove estilos padr√£o do navegador */
        * {
            margin: 0;           /* Remove espa√ßamento externo */
            padding: 0;          /* Remove espa√ßamento interno */
            box-sizing: border-box;  /* Facilita c√°lculos de tamanho */
        }

        /* Estilo do corpo da p√°gina (body) */
        body {
            font-family: Arial, sans-serif;  /* Fonte padr√£o */
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);  /* Fundo com gradiente roxo */
            min-height: 100vh;   /* Altura m√≠nima = 100% da tela (viewport height) */
            padding: 20px;       /* Espa√ßamento interno de 20 pixels */
        }

        /* Container principal: caixa branca no centro */
        .container {
            max-width: 800px;    /* Largura m√°xima de 800 pixels */
            margin: 0 auto;      /* Centraliza horizontalmente (auto nas laterais) */
            background: white;   /* Fundo branco */
            border-radius: 10px; /* Bordas arredondadas */
            padding: 30px;       /* Espa√ßamento interno */
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);  /* Sombra para dar profundidade */
        }

        /* T√≠tulo principal */
        h1 {
            color: #333;         /* Cor do texto: cinza escuro */
            margin-bottom: 30px; /* Espa√ßo abaixo do t√≠tulo */
            text-align: center;  /* Texto centralizado */
        }

        /* Se√ß√µes: cada "bloco" de funcionalidade */
        .section {
            margin-bottom: 40px; /* Espa√ßo entre se√ß√µes */
            padding: 20px;       /* Espa√ßamento interno */
            background: #f8f9fa; /* Fundo cinza claro */
            border-radius: 8px;  /* Bordas arredondadas */
        }

        /* T√≠tulos das se√ß√µes */
        .section h2 {
            color: #ea66e3;      /* Cor roxa */
            margin-bottom: 15px; /* Espa√ßo abaixo */
        }

        /* Bot√µes */
        button {
            background: #eab566; /* Cor de fundo roxa */
            color: white;        /* Cor do texto: branco */
            border: none;       /* Remove borda padr√£o */
            padding: 12px 24px; /* Espa√ßamento interno (vertical horizontal) */
            border-radius: 5px; /* Bordas arredondadas */
            cursor: pointer;    /* Cursor vira "m√£ozinha" ao passar o mouse */
            font-size: 16px;    /* Tamanho da fonte */
            margin-right: 10px; /* Espa√ßo √† direita */
            margin-bottom: 10px; /* Espa√ßo abaixo */
        }

        /* Quando passar o mouse sobre o bot√£o */
        button:hover {
            background: #5568d3; /* Cor mais escura */
        }

        /* Campos de input (entrada de dados) */
        input {
            padding: 10px;      /* Espa√ßamento interno */
            border: 1px solid #ddd;  /* Borda cinza clara */
            border-radius: 5px; /* Bordas arredondadas */
            margin: 5px;        /* Espa√ßamento externo */
            font-size: 14px;    /* Tamanho da fonte */
        }

        /* √Åreas de resultado */
        #resultado-frutas, #resultado-soma {
            margin-top: 15px;   /* Espa√ßo acima */
            padding: 15px;      /* Espa√ßamento interno */
            background: white;  /* Fundo branco */
            border-radius: 5px; /* Bordas arredondadas */
            border-left: 4px solid #667eea;  /* Borda esquerda roxa (destaque) */
        }

        /* Cada item de fruta na lista */
        .fruta-item {
            padding: 10px;      /* Espa√ßamento interno */
            margin: 5px 0;      /* Espa√ßo acima e abaixo */
            background: #e9ecef; /* Fundo cinza bem claro */
            border-radius: 5px; /* Bordas arredondadas */
        }

        /* Mensagem de carregamento */
        .loading {
            color: #667eea;     /* Cor roxa */
            font-style: italic; /* Texto em it√°lico */
        }

        /* Mensagem de erro */
        .erro {
            color: #dc3545;     /* Cor vermelha */
            background: #f8d7da; /* Fundo vermelho claro */
            padding: 10px;      /* Espa√ßamento interno */
            border-radius: 5px; /* Bordas arredondadas */
            margin-top: 10px;   /* Espa√ßo acima */
        }
    </style>
</head>
<body>
    <!-- ============================================
         CONTE√öDO VISUAL DA P√ÅGINA (HTML)
         ============================================ -->
    
    <!-- Container principal: envolve todo o conte√∫do -->
    <div class="container">
        <!-- T√≠tulo principal da p√°gina -->
        <h1>üçé APIi Frontend - Exerc√≠cio</h1>

        <!-- ============================================
             SE√á√ÉO 1: Carregar Frutas
             ============================================ -->
        <div class="section">
            <h2>1. Carregar Frutas</h2>
            
            <!-- Bot√£o que chama a fun√ß√£o carregarFrutas() quando clicado -->
            <!-- onclick = evento que acontece quando o usu√°rio clica -->
            <button onclick="carregarFrutas()">Carregar Frutas</button>
            
            <!-- Div onde o resultado ser√° exibido -->
            <!-- id = identificador √∫nico para encontrar este elemento no JavaScript -->
            <div id="resultado-frutas"></div>
        </div>

        <!-- ============================================
             SE√á√ÉO 2: Soma de N√∫meros
             ============================================ -->
        <div class="section">
            <h2>2. Soma de N√∫meros</h2>
            
            <!-- Input para o primeiro n√∫mero -->
            <!-- type="number" = s√≥ aceita n√∫meros -->
            <!-- id = identificador para pegar o valor no JavaScript -->
            <!-- placeholder = texto que aparece quando est√° vazio -->
            <!-- value = valor inicial -->
            <input type="number" id="numero-a" placeholder="N√∫mero A" value="5">
            <input type="number" id="numero-b" placeholder="N√∫mero B" value="3">
            
            <!-- Bot√£o que chama a fun√ß√£o calcularSoma() quando clicado -->
            <button onclick="calcularSoma()">Calcular Soma</button>
            
            <!-- Div onde o resultado da soma ser√° exibido -->
            <div id="resultado-soma"></div>
        </div>
    </div>

    <!-- ============================================
         C√ìDIGO JAVASCRIPT (L√≥gica e Interatividade)
         ============================================
         JavaScript = linguagem de programa√ß√£o que torna a p√°gina "viva"
         √â o que faz as coisas acontecerem quando voc√™ clica em bot√µes
    -->
    <script>
        // ============================================
        // CONFIGURA√á√ÉO DA URL DA API
        // ============================================
        // A API (backend) est√° rodando em outro lugar
        // Precisamos saber o "endere√ßo" para fazer requisi√ß√µes
        
        // Detecta se est√° rodando em Docker ou localmente
        const API_URL = window.location.hostname === 'localhost' 
            ? 'http://localhost:3000' 
            : 'http://backend:3000';
        
        // URL p√∫blica: sempre usa localhost porque o navegador do usu√°rio
        // precisa acessar pela porta exposta do Docker
        const API_URL_PUBLIC = 'http://localhost:3000';

        // ============================================
        // FUN√á√ÉO 1: Carregar Frutas
        // ============================================
        // async = fun√ß√£o ass√≠ncrona (pode demorar para executar)
        // await = espera a resposta antes de continuar
        
        async function carregarFrutas() {
            // Passo 1: Encontrar o elemento HTML onde vamos mostrar o resultado
            // document.getElementById() = procura um elemento pelo ID
            const resultadoDiv = document.getElementById('resultado-frutas');
            
            // Passo 2: Mostrar mensagem de "carregando" enquanto busca os dados
            // innerHTML = conte√∫do HTML dentro do elemento
            resultadoDiv.innerHTML = '<p class="loading">Carregando frutas...</p>';

            // Passo 3: Tentar fazer a requisi√ß√£o para a API
            // try = tenta executar (se der erro, vai para o catch)
            try {
                // fetch() = fun√ß√£o que faz requisi√ß√£o HTTP (busca dados na internet)
                // √â como fazer um pedido ao gar√ßom do restaurante
                // await = espera a resposta chegar antes de continuar
                const response = await fetch(`${API_URL_PUBLIC}/pega-frutas`);
                
                // response.json() = converte a resposta em formato JSON para objeto JavaScript
                // await = espera a convers√£o terminar
                const data = await response.json();
                // Agora 'data' cont√©m: { sucesso: true, frutas: [...] }

                // Passo 4: Verificar se deu certo
                if (data.sucesso) {
                    // Se deu certo, vamos criar o HTML para mostrar as frutas
                    let html = '<h3>Frutas carregadas:</h3>';
                    
                    // forEach = percorre cada item do array
                    // √â como olhar cada fruta na lista, uma por uma
                    data.frutas.forEach(fruta => {
                        // Para cada fruta, adiciona um peda√ßo de HTML
                        // Template string (backticks ``) permite usar vari√°veis dentro do texto
                        html += `
                            <div class="fruta-item">
                                <strong>${fruta.nome}</strong> - Cooor: ${fruta.cor}
                            </div>
                        `;
                        // ${fruta.nome} = pega o valor da propriedade 'nome' do objeto fruta
                    });
                    
                    // Coloca o HTML criado dentro da div de resultado
                    resultadoDiv.innerHTML = html;
                } else {
                    // Se n√£o deu certo, mostra mensagem de erro
                    resultadoDiv.innerHTML = '<p class="erro">Erro ao carregar frutas</p>';
                }
            } catch (error) {
                // catch = se der algum erro (ex: servidor n√£o est√° rodando)
                // Mostra mensagem de erro com detalhes
                resultadoDiv.innerHTML = `<p class="erro">Erro: ${error.message}. Verifique se o backend est√° rodando!</p>`;
            }
        }

        // ============================================
        // FUN√á√ÉO 2: Calcular Soma
        // ============================================
        async function calcularSoma() {
            // Passo 1: Encontrar os elementos HTML
            const resultadoDiv = document.getElementById('resultado-soma');
            
            // Passo 2: Pegar os valores dos inputs
            // .value = pega o texto que o usu√°rio digitou
            const a = document.getElementById('numero-a').value;
            const b = document.getElementById('numero-b').value;

            // Passo 3: Validar se os campos est√£o preenchidos
            // !a = se 'a' estiver vazio (falsy)
            if (!a || !b) {
                // Se algum campo estiver vazio, mostra erro e para aqui (return)
                resultadoDiv.innerHTML = '<p class="erro">Por favor, preencha ambos os n√∫meros!</p>';
                return;  // Para a execu√ß√£o da fun√ß√£o aqui
            }

            // Passo 4: Mostrar mensagem de "calculando"
            resultadoDiv.innerHTML = '<p class="loading">Calculando...</p>';

            // Passo 5: Fazer requisi√ß√£o para a API
            try {
                // Monta a URL com os par√¢metros: /soma?a=5&b=3
                // Template string permite inserir vari√°veis: ${a} e ${b}
                const response = await fetch(`${API_URL_PUBLIC}/soma?a=${a}&b=${b}`);
                
                // Converte resposta para objeto JavaScript
                const data = await response.json();

                // Passo 6: Verificar se deu certo
                if (data.sucesso) {
                    // Mostra o resultado formatado
                    resultadoDiv.innerHTML = `
                        <h3>Resultadoooo:</h3>
                        <p><strong>${data.a} + ${data.b} = ${data.resultado}</strong></p>
                    `;
                } else {
                    // Se a API retornou erro, mostra a mensagem de erro
                    resultadoDiv.innerHTML = `<p class="erro">${data.erro}</p>`;
                }
            } catch (error) {
                // Se der erro na requisi√ß√£o (ex: servidor offline)
                resultadoDiv.innerHTML = `<p class="erro">Erro: ${error.message}. Verifique se o backend est√° rodando!</p>`;
            }
        }
        
        // ============================================
        // RESUMO DO FLUXO:
        // ============================================
        // 1. Usu√°rio clica no bot√£o
        // 2. Fun√ß√£o JavaScript √© executada
        // 3. Fun√ß√£o faz requisi√ß√£o HTTP para o backend (fetch)
        // 4. Backend processa e retorna dados (JSON)
        // 5. Frontend recebe os dados
        // 6. Frontend atualiza a p√°gina com os dados (innerHTML)
        // 7. Usu√°rio v√™ o resultado na tela
    </script>
</body>
</html>
